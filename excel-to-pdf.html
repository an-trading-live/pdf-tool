<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Excel to PDF â€“ PDF Tools Pro</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%); }
    .drop-zone { transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); border: 2px dashed #e0e0e0; }
    .drop-zone.dragover { border-color: #22c55e; background: #dcfce7; transform: scale(1.02); box-shadow: 0 4px 6px rgba(34, 197, 94, 0.1); }
    .progress-bar { height: 4px; background: linear-gradient(to right, #22c55e, #10b981); transition: width 0.4s ease-out; }
    .btn-download { background: linear-gradient(135deg, #22c55e 0%, #10b981 100%); box-shadow: 0 10px 15px -3px rgba(34, 197, 94, 0.1), 0 4px 6px -2px rgba(34, 197, 94, 0.05); transition: all 0.3s ease; }
    .btn-download:hover { transform: translateY(-2px); box-shadow: 0 15px 20px -5px rgba(34, 197, 94, 0.2); }
    .pulse { animation: pulse 2s infinite ease-in-out; }
    @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    .fade-in { animation: fadeIn 0.5s ease-in; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body class="min-h-screen py-12 px-4 sm:px-6 lg:px-8">

  <!-- Back Button -->
  <div class="max-w-3xl mx-auto mb-8">
    <a href="index.html" class="inline-flex items-center text-green-600 hover:text-green-800 font-medium text-sm">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
      Back to Dashboard
    </a>
  </div>

  <div class="max-w-3xl mx-auto" x-data="excelTool()">
    <div class="text-center mb-12 fade-in">
      <h1 class="text-4xl font-bold text-gray-900 mb-2">Excel to PDF</h1>
      <p class="text-lg text-gray-600">Convert Excel sheets to PDF with precision.</p>
    </div>

    <!-- File Upload -->
    <div class="mb-6">
      <label class="block text-sm font-medium text-gray-700 mb-2">Excel File</label>
      <div class="drop-zone rounded-xl p-6 bg-white shadow-md cursor-pointer"
           :class="{ 'dragover': dragging }"
           @dragover.prevent="dragging = true"
           @dragleave.prevent="dragging = false"
           @drop.prevent="handleDrop($event)"
           @click="$refs.fileInput.click()">
        <input type="file" accept=".xlsx,.xls" x-ref="fileInput" class="hidden" @change="handleFile($event)" />
        <div class="text-center">
          <svg class="w-12 h-12 mx-auto mb-3 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"/>
          </svg>
          <p class="text-sm text-gray-600" x-show="!file">Drag & drop or click to upload Excel</p>
          <p class="text-sm font-medium text-green-600" x-show="file" x-text="file.name"></p>
        </div>
      </div>
    </div>

    <!-- Sheet Options -->
    <div class="grid grid-cols-2 gap-4 mb-6">
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Sheet Name (optional)</label>
        <input type="text" x-model="sheetName" placeholder="e.g., Sales" class="w-full rounded-xl border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500" />
      </div>
      <div>
        <label class="block text-sm font-medium text-gray-700 mb-2">Sheet Index (optional)</label>
        <input type="number" x-model="sheetIndex" placeholder="e.g., 0" class="w-full rounded-xl border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500" />
      </div>
    </div>

    <!-- Convert Button -->
    <button @click="upload" :disabled="uploading" class="w-full py-3 px-4 bg-green-600 text-white font-semibold rounded-xl shadow-md hover:bg-green-700 transition disabled:opacity-50">
      Convert to PDF
    </button>

    <!-- Progress -->
    <div class="mt-6" x-show="uploading">
      <div class="bg-green-100 rounded-full overflow-hidden">
        <div class="progress-bar" :style="{ width: progress + '%' }"></div>
      </div>
      <p class="text-center text-sm text-gray-600 mt-2" x-text="`Converting... ${progress}%`"></p>
    </div>

    <!-- Download -->
    <div class="mt-6" x-show="downloadUrl">
      <a :href="downloadUrl" download="converted.pdf" class="block py-3 px-4 bg-green-600 text-white font-semibold rounded-xl shadow-md hover:bg-green-700 transition pulse text-center">
        Download PDF
      </a>
    </div>
  </div>

  <script>
    function excelTool() {
      return {
        file: null, dragging: false, sheetName: '', sheetIndex: '',
        uploading: false, progress: 0, downloadUrl: '',

        handleFile(e) { this.file = e.target.files[0]; },
        handleDrop(e) { this.dragging = false; this.file = e.dataTransfer.files[0]; },

        async upload() {
          if (!this.file) return alert('Upload an Excel file!');
          this.uploading = true; this.progress = 0;
          const formData = new FormData();
          formData.append('file_excel', this.file);
          if (this.sheetName) formData.append('sheet_name', this.sheetName);
          if (this.sheetIndex) formData.append('sheet_index', this.sheetIndex);

          const interval = setInterval(() => this.progress = Math.min(this.progress + 10, 90), 200);

          try {
            const res = await fetch('https://pdf-tools-jmnh.onrender.com/excel-to-pdf', { method: 'POST', body: formData });
            clearInterval(interval); this.progress = 100;
            if (!res.ok) throw new Error(await res.text());
            const blob = await res.blob();
            this.downloadUrl = URL.createObjectURL(blob);
          } catch (e) {
            alert('Error: ' + e.message);
          } finally {
            this.uploading = false;
          }
        }
      };
    }
  </script>
</body>
</html>